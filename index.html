<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Type Classes: Functor</title>
<meta name="author" content="(Tim McIver)"/>
<style type="text/css">
.underline { text-decoration: underline; }
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@3.8.0/css/reveal.css"/>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reveal.js@3.8.0/css/theme/moon.css" id="theme"/>


<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
    if( window.location.search.match( /print-pdf/gi ) ) {
        var link = document.createElement( 'link' );
        link.rel = 'stylesheet';
        link.type = 'text/css';
        link.href = 'https://cdn.jsdelivr.net/npm/reveal.js@3.8.0/css/print/pdf.css';
        document.getElementsByTagName( 'head' )[0].appendChild( link );
    }
</script>
</head>
<body>
<div class="reveal">
<div class="slides">
<section id="sec-title-slide"><h1 class="title">Type Classes: Functor</h1><h2 class="author">Tim McIver</h2>
</section>

<section>
<section id="slide-sec-">
<h2 id="org7951a40">APIs, Interfaces, Abstraction</h2>
<ul>
<li>Talk about how much of programming is coding to an interface as a lead-in to Functor being a high-level API.<br /></li>

</ul>

</section>
</section>
<section>
<section id="slide-sec-">
<h2 id="orgb8689f7">Iteration Over Lists, Arrays, Vectors, etc.</h2>
<div class="outline-text-2" id="text-orgb8689f7">
</div>
</section>
<section id="slide-sec-">
<h3 id="org11a5b41">One of the Most Common Operations in Programming</h3>

</section>
<section id="slide-sec-">
<h3 id="orgf83722e"></h3>
<p>
Contrived PHP example 1:<br />
Uppercase an array of strings<br />
</p>

<div class="org-src-container">

<pre  class="src src-php"><code trim><span style="color: #b4fa70;">function</span> <span style="color: #fce94f;">uppercaseWords</span>(<span style="color: #8cc4ff;">array</span> <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">words</span>) {
  <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">uppercased</span> = [];
  <span style="color: #b4fa70;">foreach</span> (<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">words</span> <span style="color: #b4fa70;">as</span> <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">word</span>) {
    <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">uppercased</span>[] = strtoupper(<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">word</span>);
  }
  <span style="color: #b4fa70;">return</span> <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">uppercased</span>;
}
<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">words</span> = [<span style="color: #e9b96e;">"functional"</span>, <span style="color: #e9b96e;">"programming"</span>, <span style="color: #e9b96e;">"rocks"</span>];
print_r(uppercaseWords(<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">words</span>));
</code></pre>
</div>
<pre class="example">
Array
(
    [0] =&gt; FUNCTIONAL
    [1] =&gt; PROGRAMMING
    [2] =&gt; ROCKS
)
</pre>

</section>
<section id="slide-sec-">
<h3 id="org89d55c1"></h3>
<p>
Contrived PHP example 2:<br />
Increment an array of ints:<br />
</p>

<div class="org-src-container">

<pre  class="src src-php"><code trim><span style="color: #b4fa70;">function</span> <span style="color: #fce94f;">incrementInts</span>(<span style="color: #8cc4ff;">array</span> <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">ints</span>) {
  <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">incd</span> = [];
  <span style="color: #b4fa70;">foreach</span> (<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">ints</span> <span style="color: #b4fa70;">as</span> <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">i</span>) {
    <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">incd</span>[] = <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">i</span> + 1;
  }
  <span style="color: #b4fa70;">return</span> <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">incd</span>;
}
<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">ints</span> = [1, 2, 3];
print_r(incrementInts(<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">ints</span>));
</code></pre>
</div>
<pre class="example">
Array
(
    [0] =&gt; 2
    [1] =&gt; 3
    [2] =&gt; 4
)
</pre>

</section>
<section id="slide-sec-">
<h3 id="org2f604c3"></h3>
<p>
There's a lot in common in these examples.<br />
</p>
<div class="column" style="float:left; width: 50%">

<div class="org-src-container">

<pre  class="src src-php"><code trim><span style="color: #b4fa70;">function</span> <span style="color: #fce94f;">uppercaseWords</span>(<span style="color: #8cc4ff;">array</span> <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">words</span>) {
  <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">uppercased</span> = [];
  <span style="color: #b4fa70;">foreach</span> (<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">words</span> <span style="color: #b4fa70;">as</span> <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">word</span>) {
    <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">uppercased</span>[] = strtoupper(<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">word</span>);
  }
  <span style="color: #b4fa70;">return</span> <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">uppercased</span>;
}
</code></pre>
</div>

</div>
<div class="column" style="float:right; width: 50%">

<div class="org-src-container">

<pre  class="src src-php"><code trim><span style="color: #b4fa70;">function</span> <span style="color: #fce94f;">incrementInts</span>(<span style="color: #8cc4ff;">array</span> <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">ints</span>) {
  <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">incd</span> = [];
  <span style="color: #b4fa70;">foreach</span> (<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">ints</span> <span style="color: #b4fa70;">as</span> <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">i</span>) {
    <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">incd</span>[] = <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">i</span> + 1;
  }
  <span style="color: #b4fa70;">return</span> <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">incd</span>;
}
</code></pre>
</div>

</div>

</section>
<section id="slide-sec-">
<h3 id="orgec79ffd"></h3>
<p>
Let's factor out what's common;<br />
parameterize what's different<br />
</p>
<div class="org-src-container">

<pre  class="src src-php"><code trim><span style="color: #b4fa70;">function</span> <span style="color: #fce94f;">applyFunctionForEach</span>(<span style="color: #8cc4ff;">array</span> <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">arr</span>, <span style="color: #8cc4ff;">callable</span> <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">f</span>) {
  <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">res</span> = [];
  <span style="color: #b4fa70;">foreach</span> (<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">arr</span> <span style="color: #b4fa70;">as</span> <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">i</span>) {
    <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">res</span>[] = <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">f</span>(<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">i</span>);
  }
  <span style="color: #b4fa70;">return</span> <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">res</span>;
}
</code></pre>
</div>

</section>
<section id="slide-sec-">
<h3 id="orgb4fa375"></h3>
<p>
Then <code>uppercaseWords</code> becomes:<br />
</p>
<div class="org-src-container">

<pre  class="src src-php"><code trim><span style="color: #b4fa70;">function</span> <span style="color: #fce94f;">upperCase</span>(<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">s</span>) { <span style="color: #b4fa70;">return</span> strtoupper(<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">s</span>); }
<span style="color: #b4fa70;">function</span> <span style="color: #fce94f;">uppercaseWords</span>(<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">words</span>) {
  <span style="color: #b4fa70;">return</span> applyFunctionForEach(<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">words</span>, <span style="color: #e9b96e;">'upperCase'</span>);
}
<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">words</span> = [<span style="color: #e9b96e;">"functional"</span>, <span style="color: #e9b96e;">"programming"</span>, <span style="color: #e9b96e;">"rocks"</span>];
print_r(uppercaseWords(<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">words</span>));
</code></pre>
</div>

</section>
<section id="slide-sec-">
<h3 id="orga641f64"></h3>
<p>
and <code>incrementInts</code> becomes:<br />
</p>
<div class="org-src-container">

<pre  class="src src-php"><code trim><span style="color: #b4fa70;">function</span> <span style="color: #fce94f;">inc</span>(<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">i</span>) { <span style="color: #b4fa70;">return</span> <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">i</span> + 1; }
<span style="color: #b4fa70;">function</span> <span style="color: #fce94f;">incrementInts</span>(<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">ints</span>) {
  <span style="color: #b4fa70;">return</span> applyFunctionForEach(<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">ints</span>, <span style="color: #e9b96e;">'inc'</span>);
}
<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">ints</span> = [1, 2, 3];
print_r(incrementInts(<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">ints</span>));
</code></pre>
</div>

</section>
</section>
<section>
<section id="slide-sec-">
<h2 id="orgbd8e3bf">Iteration Over Trees</h2>
<div class="outline-text-2" id="text-orgbd8e3bf">
</div>
</section>
<section id="slide-sec-">
<h3 id="org2bbde93">A Binary Tree</h3>
<div class="org-src-container">

<pre  class="src src-php"><code trim><span style="color: #b4fa70;">interface</span> <span style="color: #8cc4ff;">BinaryTree</span> {}
<span style="color: #b4fa70;">class</span> <span style="color: #8cc4ff;">Node</span> <span style="color: #b4fa70;">implements</span> <span style="color: #8cc4ff;">BinaryTree</span> {
  <span style="color: #b4fa70;">private</span> <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">left</span>;
  <span style="color: #b4fa70;">private</span> <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">right</span>;
  <span style="color: #b4fa70;">private</span> <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">val</span>;
  <span style="color: #b4fa70;">public</span> <span style="color: #b4fa70;">function</span> <span style="color: #fce94f;">__construct</span>(<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">left</span>, <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">right</span>, <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">val</span>) {
    <span style="color: #e9b2e3;">$</span><span style="color: #e9b2e3;">this</span><span style="color: #eeeeec; background-color: #2e3436;">-&gt;</span><span style="color: #fcaf3e;">left</span> = <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">left</span>;
    <span style="color: #e9b2e3;">$</span><span style="color: #e9b2e3;">this</span><span style="color: #eeeeec; background-color: #2e3436;">-&gt;</span><span style="color: #fcaf3e;">right</span> = <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">right</span>;
    <span style="color: #e9b2e3;">$</span><span style="color: #e9b2e3;">this</span><span style="color: #eeeeec; background-color: #2e3436;">-&gt;</span><span style="color: #fcaf3e;">val</span> = <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">val</span>;
  }
  <span style="color: #73d216;">// </span><span style="color: #73d216;">getters elided</span>
}
<span style="color: #b4fa70;">class</span> <span style="color: #8cc4ff;">Leaf</span> <span style="color: #b4fa70;">implements</span> <span style="color: #8cc4ff;">BinaryTree</span> {}
</code></pre>
</div>

</section>
<section id="slide-sec-">
<h3 id="org12ea74e">An Instance of a Binary Tree</h3>
<div class="org-src-container">

<pre  class="src src-php"><code trim><span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">leaf</span> = <span style="color: #b4fa70;">new</span> <span style="color: #8cc4ff;">Leaf</span>();
<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">tree</span> = <span style="color: #b4fa70;">new</span> <span style="color: #8cc4ff;">Node</span>(
  <span style="color: #b4fa70;">new</span> <span style="color: #8cc4ff;">Node</span>(<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">leaf</span>, <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">leaf</span>, <span style="color: #e9b96e;">"functional"</span>),
  <span style="color: #b4fa70;">new</span> <span style="color: #8cc4ff;">Node</span>(<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">leaf</span>, <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">leaf</span>, <span style="color: #e9b96e;">"rocks"</span>),
  <span style="color: #e9b96e;">"programming"</span>
);
</code></pre>
</div>

</section>
<section id="slide-sec-">
<h3 id="org86cccbe"></h3>
<p>
Let's try to uppercase the strings in a binary tree.<br />
</p>
<div class="org-src-container">

<pre  class="src src-php"><code trim><span style="color: #b4fa70;">function</span> <span style="color: #fce94f;">uppercaseBinaryTree</span>(<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">btree</span>) {
  <span style="color: #b4fa70;">if</span> (<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">btree</span> <span style="color: #b4fa70;">instanceof</span> <span style="color: #8cc4ff;">Node</span>) {
    <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">newLeft</span> = uppercaseBinaryTree(<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">btree</span><span style="color: #eeeeec; background-color: #2e3436;">-&gt;</span><span style="color: #eeeeec; background-color: #2e3436;">getLeftNode</span>());
    <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">newRight</span> = uppercaseBinaryTree(<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">btree</span><span style="color: #eeeeec; background-color: #2e3436;">-&gt;</span><span style="color: #eeeeec; background-color: #2e3436;">getRightNode</span>());
    <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">newStr</span> = strtoupper(<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">btree</span><span style="color: #eeeeec; background-color: #2e3436;">-&gt;</span><span style="color: #eeeeec; background-color: #2e3436;">getVal</span>());
    <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">newNode</span> = <span style="color: #b4fa70;">new</span> <span style="color: #8cc4ff;">Node</span>(<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">newLeft</span>, <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">newRight</span>, <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">newStr</span>);
  } <span style="color: #b4fa70;">else</span> {
    <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">newNode</span> = <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">btree</span>;
  }
  <span style="color: #b4fa70;">return</span> <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">newNode</span>;
}
print_r(uppercaseBinaryTree(<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">tree</span>));
</code></pre>
</div>

</section>
<section id="slide-sec-">
<h3 id="orgfc190e7"></h3>
<p>
But that's not very OO-ey. Instead let's define it as a method.<br />
</p>
<div class="org-src-container">

<pre  class="src src-php"><code trim><span style="color: #b4fa70;">interface</span> <span style="color: #8cc4ff;">BinaryTree</span> {
  <span style="color: #b4fa70;">function</span> <span style="color: #fce94f;">uppercase</span>();
}
</code></pre>
</div>

</section>
<section id="slide-sec-">
<h3 id="org379a0fb"></h3>
<p>
And implement it:<br />
</p>
<div class="org-src-container">

<pre  class="src src-php"><code trim><span style="color: #b4fa70;">class</span> <span style="color: #8cc4ff;">Node</span> <span style="color: #b4fa70;">implements</span> <span style="color: #8cc4ff;">BinaryTree</span> {
  <span style="color: #73d216;">// </span><span style="color: #73d216;">boring stuff elided</span>

  <span style="color: #b4fa70;">public</span> <span style="color: #b4fa70;">function</span> <span style="color: #fce94f;">uppercase</span>() {
    <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">newLeft</span> = <span style="color: #e9b2e3;">$</span><span style="color: #e9b2e3;">this</span><span style="color: #eeeeec; background-color: #2e3436;">-&gt;</span><span style="color: #fcaf3e;">left</span><span style="color: #eeeeec; background-color: #2e3436;">-&gt;</span><span style="color: #eeeeec; background-color: #2e3436;">uppercase</span>();
    <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">newRight</span> = <span style="color: #e9b2e3;">$</span><span style="color: #e9b2e3;">this</span><span style="color: #eeeeec; background-color: #2e3436;">-&gt;</span><span style="color: #fcaf3e;">right</span><span style="color: #eeeeec; background-color: #2e3436;">-&gt;</span><span style="color: #eeeeec; background-color: #2e3436;">uppercase</span>();
    <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">newStr</span> = strtoupper(<span style="color: #e9b2e3;">$</span><span style="color: #e9b2e3;">this</span><span style="color: #eeeeec; background-color: #2e3436;">-&gt;</span><span style="color: #fcaf3e;">val</span>);
    <span style="color: #b4fa70;">return</span> <span style="color: #b4fa70;">new</span> <span style="color: #8cc4ff;">Node</span>(<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">newLeft</span>, <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">newRight</span>, <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">newStr</span>);
  }
}
<span style="color: #b4fa70;">class</span> <span style="color: #8cc4ff;">Leaf</span> <span style="color: #b4fa70;">implements</span> <span style="color: #8cc4ff;">BinaryTree</span> {
  <span style="color: #b4fa70;">public</span> <span style="color: #b4fa70;">function</span> <span style="color: #fce94f;">uppercase</span>() {
    <span style="color: #b4fa70;">return</span> <span style="color: #e9b2e3;">$</span><span style="color: #e9b2e3;">this</span>;
  }
}
</code></pre>
</div>

</section>
<section id="slide-sec-">
<h3 id="org57f38ba"></h3>
<p>
Then uppercasing a binary tree of strings becomes:<br />
</p>
<div class="org-src-container">

<pre  class="src src-php"><code trim><span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">tree</span><span style="color: #eeeeec; background-color: #2e3436;">-&gt;</span><span style="color: #eeeeec; background-color: #2e3436;">uppercase</span>();
</code></pre>
</div>

</section>
<section id="slide-sec-">
<h3 id="orgb6b60e4"></h3>
<p>
But the <code>uppercase</code> method is very specific.  We'd like to have something that allows us to perform <b>any</b> operation on the values inside a binary tree.<br />
Let's do for <code>BinaryTree</code> what we did for PHP arrays.<br />
</p>
<div class="org-src-container">

<pre  class="src src-php"><code trim><span style="color: #b4fa70;">interface</span> <span style="color: #8cc4ff;">BinaryTree</span> {
  <span style="color: #b4fa70;">function</span> <span style="color: #fce94f;">applyFunctionToEachNodeValue</span>(<span style="color: #8cc4ff;">callable</span> <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">f</span>);
}
</code></pre>
</div>

</section>
<section id="slide-sec-">
<h3 id="org126eab6"></h3>
<p>
And the implementation:<br />
</p>
<div class="org-src-container">

<pre  class="src src-php"><code trim><span style="color: #b4fa70;">class</span> <span style="color: #8cc4ff;">Node</span> <span style="color: #b4fa70;">implements</span> <span style="color: #8cc4ff;">BinaryTree</span> {
  <span style="color: #73d216;">// </span><span style="color: #73d216;">boring stuff elided</span>

  <span style="color: #b4fa70;">public</span> <span style="color: #b4fa70;">function</span> <span style="color: #fce94f;">applyFunctionToEachNodeValue</span>(<span style="color: #8cc4ff;">callable</span> <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">f</span>) {
    <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">newLeft</span> = <span style="color: #e9b2e3;">$</span><span style="color: #e9b2e3;">this</span><span style="color: #eeeeec; background-color: #2e3436;">-&gt;</span><span style="color: #fcaf3e;">left</span><span style="color: #eeeeec; background-color: #2e3436;">-&gt;</span><span style="color: #eeeeec; background-color: #2e3436;">applyFunctionToEachNodeValue</span>(<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">f</span>);
    <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">newRight</span> = <span style="color: #e9b2e3;">$</span><span style="color: #e9b2e3;">this</span><span style="color: #eeeeec; background-color: #2e3436;">-&gt;</span><span style="color: #fcaf3e;">right</span><span style="color: #eeeeec; background-color: #2e3436;">-&gt;</span><span style="color: #eeeeec; background-color: #2e3436;">applyFunctionToEachNodeValue</span>(<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">f</span>);
    <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">newStr</span> = <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">f</span>(<span style="color: #e9b2e3;">$</span><span style="color: #e9b2e3;">this</span><span style="color: #eeeeec; background-color: #2e3436;">-&gt;</span><span style="color: #fcaf3e;">val</span>);
    <span style="color: #b4fa70;">return</span> <span style="color: #b4fa70;">new</span> <span style="color: #8cc4ff;">Node</span>(<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">newLeft</span>, <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">newRight</span>, <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">newStr</span>);
  }
}
<span style="color: #b4fa70;">class</span> <span style="color: #8cc4ff;">Leaf</span> <span style="color: #b4fa70;">implements</span> <span style="color: #8cc4ff;">BinaryTree</span> {
  <span style="color: #b4fa70;">public</span> <span style="color: #b4fa70;">function</span> <span style="color: #fce94f;">applyFunctionToEachNodeValue</span>(<span style="color: #8cc4ff;">callable</span> <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">f</span>) {
    <span style="color: #b4fa70;">return</span> <span style="color: #e9b2e3;">$</span><span style="color: #e9b2e3;">this</span>;
  }
}
</code></pre>
</div>

</section>
<section id="slide-sec-">
<h3 id="org2a029f2"></h3>
<p>
And now our <code>uppercaseBinaryTree</code> function can be written as<br />
</p>
<div class="org-src-container">

<pre  class="src src-php"><code trim><span style="color: #b4fa70;">function</span> <span style="color: #fce94f;">uppercaseBinaryTree</span>(<span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">btree</span>) {
  <span style="color: #b4fa70;">return</span> <span style="color: #eeeeec; background-color: #2e3436;">$</span><span style="color: #fcaf3e;">btree</span><span style="color: #eeeeec; background-color: #2e3436;">-&gt;</span><span style="color: #eeeeec; background-color: #2e3436;">applyFunctionToEachNodeValue</span>(<span style="color: #e9b96e;">'strtoupper'</span>);
}
</code></pre>
</div>

</section>
</section>
<section>
<section id="slide-sec-">
<h2 id="orgc1022fe">Digression: The Option/Maybe Type</h2>
<div class="outline-text-2" id="text-orgc1022fe">
</div>
</section>
<section id="slide-sec-">
<h3 id="org3273e87">Null Is Terrible</h3>
<ul>
<li>The creator of the null reference (Tony Hoare) called it his "Billion-dollar mistake"<br /></li>
<li><a href="https://blog.overops.com/the-top-10-exceptions-types-in-production-java-applications-based-on-1b-events/">Largest source of exceptions in Java</a><br /></li>
<li>It adds this extra value to every type but does not honor any of their contracts.<br /></li>
<li>In C, two null values of any type compare as equal.<br /></li>

</ul>

</section>
<section id="slide-sec-">
<h3 id="orgd4aa6d1">So What's the Alternative?</h3>
<p class="fragment (appear)">
An Option/Maybe Type!<br />
</p>
<p class="fragment (appear)">
(Type <b>constructor</b>, actually)<br />
</p>

</section>
<section id="slide-sec-">
<h3 id="org5aef7de"></h3>
<p>
In Haskell, defined as<br />
</p>
<div class="org-src-container">

<pre  class="src src-haskell"><code trim><span style="color: #b4fa70;">data</span> <span style="color: #8cc4ff;">Maybe</span> a <span style="color: #fcaf3e;">=</span> <span style="color: #8cc4ff;">Just</span> a
             <span style="color: #fcaf3e;">|</span> <span style="color: #8cc4ff;">Nothing</span>
</code></pre>
</div>

</section>
<section id="slide-sec-">
<h3 id="org90d257c">Haskell Example 1: Uppercase a String</h3>
<p>
A variable of type <code>Maybe String</code>:<br />
</p>
<div class="org-src-container">

<pre  class="src src-haskell"><code trim><span style="color: #b4fa70;">import</span> <span style="color: #8cc4ff;">Data.Maybe</span>

<span style="color: #fce94f;">maybeAString</span> <span style="color: #fcaf3e;">::</span> <span style="color: #8cc4ff;">Maybe</span> <span style="color: #8cc4ff;">String</span>
<span style="color: #fce94f;">maybeAString</span> <span style="color: #fcaf3e;">=</span> <span style="color: #8cc4ff;">Just</span> <span style="color: #e9b96e;">"Portland FP Meetup"</span>
</code></pre>
</div>

<div class="fragment (appear) group">
<p>
And here's a function to uppercase a <code>Maybe String</code>:<br />
</p>

<div class="org-src-container">

<pre  class="src src-haskell"><code trim><span style="color: #fce94f;">uppercaseMaybeString</span> <span style="color: #fcaf3e;">::</span> <span style="color: #8cc4ff;">Maybe</span> <span style="color: #8cc4ff;">String</span> <span style="color: #fcaf3e;">-&gt;</span> <span style="color: #8cc4ff;">Maybe</span> <span style="color: #8cc4ff;">String</span>
<span style="color: #fce94f;">uppercaseMaybeString</span> maybeString <span style="color: #fcaf3e;">=</span> <span style="color: #b4fa70;">case</span> maybeString <span style="color: #b4fa70;">of</span>
  <span style="color: #8cc4ff;">Just</span> s <span style="color: #fcaf3e;">-&gt;</span> <span style="color: #8cc4ff;">Just</span> (toUpper s)
  <span style="color: #8cc4ff;">Nothing</span> <span style="color: #fcaf3e;">-&gt;</span> <span style="color: #8cc4ff;">Nothing</span>
</code></pre>
</div>

</div>

<div class="org-src-container">

<pre  class="fragment (appear)"><code trim><span style="color: #fce94f;">uppercaseMaybeString</span> maybeAString
</code></pre>
</div>

</section>
<section id="slide-sec-">
<h3 id="orga65cac7">Haskell Example 2: Increment an Integer</h3>
<p>
A variable of type <code>Maybe Int</code>:<br />
</p>
<div class="org-src-container">

<pre  class="src src-haskell"><code trim><span style="color: #b4fa70;">import</span> <span style="color: #8cc4ff;">Data.Maybe</span>

<span style="color: #fce94f;">maybeAString</span> <span style="color: #fcaf3e;">::</span> <span style="color: #8cc4ff;">Maybe</span> <span style="color: #8cc4ff;">Int</span>
<span style="color: #fce94f;">maybeAString</span> <span style="color: #fcaf3e;">=</span> <span style="color: #8cc4ff;">Just</span> 42
</code></pre>
</div>

<div class="fragment (appear) group">
<p>
And here's a function to increment the integer in a <code>Maybe Int</code>:<br />
</p>

<div class="org-src-container">

<pre  class="src src-haskell"><code trim><span style="color: #fce94f;">incrementMaybeInt</span> <span style="color: #fcaf3e;">::</span> <span style="color: #8cc4ff;">Maybe</span> <span style="color: #8cc4ff;">Int</span> <span style="color: #fcaf3e;">-&gt;</span> <span style="color: #8cc4ff;">Maybe</span> <span style="color: #8cc4ff;">Int</span>
<span style="color: #fce94f;">incrementMaybeInt</span> maybeInt <span style="color: #fcaf3e;">=</span> <span style="color: #b4fa70;">case</span> maybeInt <span style="color: #b4fa70;">of</span>
  <span style="color: #8cc4ff;">Just</span> i <span style="color: #fcaf3e;">-&gt;</span> <span style="color: #8cc4ff;">Just</span> (i <span style="color: #fcaf3e;">+</span> 1)
  <span style="color: #8cc4ff;">Nothing</span> <span style="color: #fcaf3e;">-&gt;</span> <span style="color: #8cc4ff;">Nothing</span>
</code></pre>
</div>

</div>

<div class="org-src-container">

<pre  class="fragment (appear)"><code trim><span style="color: #fce94f;">incrementMaybeInt</span> maybeInt
</code></pre>
</div>

</section>
<section id="slide-sec-">
<h3 id="orgd0fcec4">That looked familiar . . .  again.</h3>
<div class="column" style="float:left; width: 50%">

<div class="org-src-container">

<pre  class="src src-haskell"><code trim><span style="color: #fce94f;">uppercaseMaybeString</span> <span style="color: #fcaf3e;">::</span> <span style="color: #8cc4ff;">Maybe</span> <span style="color: #8cc4ff;">String</span> <span style="color: #fcaf3e;">-&gt;</span> <span style="color: #8cc4ff;">Maybe</span> <span style="color: #8cc4ff;">String</span>
<span style="color: #fce94f;">uppercaseMaybeString</span> maybeString <span style="color: #fcaf3e;">=</span> <span style="color: #b4fa70;">case</span> maybeString <span style="color: #b4fa70;">of</span>
  <span style="color: #8cc4ff;">Just</span> s <span style="color: #fcaf3e;">-&gt;</span> <span style="color: #8cc4ff;">Just</span> (toUpper s)
  <span style="color: #8cc4ff;">Nothing</span> <span style="color: #fcaf3e;">-&gt;</span> <span style="color: #8cc4ff;">Nothing</span>
</code></pre>
</div>

</div>
<div class="column" style="float:right; width: 50%">

<div class="org-src-container">

<pre  class="src src-haskell"><code trim><span style="color: #fce94f;">incrementMaybeInt</span> <span style="color: #fcaf3e;">::</span> <span style="color: #8cc4ff;">Maybe</span> <span style="color: #8cc4ff;">Int</span> <span style="color: #fcaf3e;">-&gt;</span> <span style="color: #8cc4ff;">Maybe</span> <span style="color: #8cc4ff;">Int</span>
<span style="color: #fce94f;">incrementMaybeInt</span> maybeInt <span style="color: #fcaf3e;">=</span> <span style="color: #b4fa70;">case</span> maybeInt <span style="color: #b4fa70;">of</span>
  <span style="color: #8cc4ff;">Just</span> i <span style="color: #fcaf3e;">-&gt;</span> <span style="color: #8cc4ff;">Just</span> (i <span style="color: #fcaf3e;">+</span> 1)
  <span style="color: #8cc4ff;">Nothing</span> <span style="color: #fcaf3e;">-&gt;</span> <span style="color: #8cc4ff;">Nothing</span>
</code></pre>
</div>

</div>

</section>
<section id="slide-sec-">
<h3 id="org317adbe">Abstract Out the Common Bits</h3>
<div class="org-src-container">

<pre  class="src src-haskell"><code trim><span style="color: #fce94f;">applyFunctionToMaybe</span> maybe f <span style="color: #fcaf3e;">=</span> <span style="color: #b4fa70;">case</span> maybe <span style="color: #b4fa70;">of</span>
  <span style="color: #8cc4ff;">Just</span> x <span style="color: #fcaf3e;">-&gt;</span> <span style="color: #8cc4ff;">Just</span> (f x)
  <span style="color: #8cc4ff;">Nothing</span> <span style="color: #fcaf3e;">-&gt;</span> <span style="color: #8cc4ff;">Nothing</span>
</code></pre>
</div>
<div class="fragment (appear) group">
<p>
What's its type?<br />
</p>
<div class="org-src-container">

<pre  class="src src-haskell"><code trim><span style="color: #fce94f;">applyFunctionToMaybe</span> <span style="color: #fcaf3e;">::</span> <span style="color: #8cc4ff;">Maybe</span> a <span style="color: #fcaf3e;">-&gt;</span> (a <span style="color: #fcaf3e;">-&gt;</span> b) <span style="color: #fcaf3e;">-&gt;</span> <span style="color: #8cc4ff;">Maybe</span> b
</code></pre>
</div>

</div>

<div class="fragment (appear) group">
<p>
And now <code>uppercaseMaybeString</code> and <code>incrementMaybeInt</code> can be defined in terms of it.<br />
</p>
<div class="org-src-container">

<pre  class="src src-haskell"><code trim><span style="color: #fce94f;">uppercaseMaybeString</span> maybe <span style="color: #fcaf3e;">=</span> applyFunctionToMaybe maybe toupper
<span style="color: #fce94f;">incrementMaybeInt</span> maybe <span style="color: #fcaf3e;">=</span> applyFunctionToMaybe maybe (<span style="color: #fcaf3e;">+</span>1)
</code></pre>
</div>

</div>

</section>
</section>
<section>
<section id="slide-sec-">
<h2 id="org0ebdcf5">Bringing It All Together</h2>
<div class="outline-text-2" id="text-org0ebdcf5">
</div>
</section>
<section id="slide-sec-">
<h3 id="orgd80a387">Look at the types (In Haskell)</h3>
<div class="org-src-container">

<pre  class="src src-haskell"><code trim><span style="color: #fce94f;">applyFunctionForEach</span>         <span style="color: #fcaf3e;">::</span> <span style="color: #8cc4ff;">Array</span> a      <span style="color: #fcaf3e;">-&gt;</span> (a <span style="color: #fcaf3e;">-&gt;</span> b) <span style="color: #fcaf3e;">-&gt;</span> <span style="color: #8cc4ff;">Array</span> b      <span style="color: #73d216;">-- </span><span style="color: #73d216;">PHP array example</span>
<span style="color: #fce94f;">applyFunctionToEachNodeValue</span> <span style="color: #fcaf3e;">::</span> <span style="color: #8cc4ff;">BinaryTree</span> a <span style="color: #fcaf3e;">-&gt;</span> (a <span style="color: #fcaf3e;">-&gt;</span> b) <span style="color: #fcaf3e;">-&gt;</span> <span style="color: #8cc4ff;">BinaryTree</span> b <span style="color: #73d216;">-- </span><span style="color: #73d216;">PHP BinaryTree example</span>
<span style="color: #fce94f;">applyFunctionToMaybe</span>         <span style="color: #fcaf3e;">::</span> <span style="color: #8cc4ff;">Maybe</span> a      <span style="color: #fcaf3e;">-&gt;</span> (a <span style="color: #fcaf3e;">-&gt;</span> b) <span style="color: #fcaf3e;">-&gt;</span> <span style="color: #8cc4ff;">Maybe</span> b      <span style="color: #73d216;">-- </span><span style="color: #73d216;">Haskell Maybe example</span>
</code></pre>
</div>

<p class="fragment (appear)">
In addition to using type variables Haskell allows us to use variable for <b>type constructors</b>.<br />
</p>
<p class="fragment (appear)">
Here we us <code>f</code> to stand in for the above type constructors.<br />
</p>

<div class="org-src-container">

<pre  class="fragment (appear)"><code trim><span style="color: #fce94f;">applyFunction</span> <span style="color: #fcaf3e;">::</span> f a <span style="color: #fcaf3e;">-&gt;</span> (a <span style="color: #fcaf3e;">-&gt;</span> b) <span style="color: #fcaf3e;">-&gt;</span> f b
</code></pre>
</div>

</section>
<section id="slide-sec-">
<h3 id="org5ce91b3"></h3>
<p>
In Haskell this function is called <code>fmap</code> and is embodied by the <code>Functor</code> type class.<br />
</p>
<div class="org-src-container">

<pre  class="src src-haskell"><code trim><span style="color: #b4fa70;">class</span> <span style="color: #8cc4ff;">Functor</span> f <span style="color: #b4fa70;">where</span>
  fmap <span style="color: #fcaf3e;">::</span> (a <span style="color: #fcaf3e;">-&gt;</span> b) <span style="color: #fcaf3e;">-&gt;</span> f a <span style="color: #fcaf3e;">-&gt;</span> f b
</code></pre>
</div>

</section>
<section id="slide-sec-">
<h3 id="org32baf46"></h3>
<p>
In Haskell data types are said to <b>have</b> instances of a given type class.<br />
</p>
<p class="fragment (appear)">
One can create instances of type classes for any type at any time.<br />
</p>
<p class="fragment (appear)">
For example, here's the <code>Functor</code> instance for <code>Maybe</code>:<br />
</p>
<div class="org-src-container">

<pre  class="fragment (appear)"><code trim><span style="color: #b4fa70;">instance</span> <span style="color: #8cc4ff;">Functor</span> <span style="color: #8cc4ff;">Maybe</span> <span style="color: #b4fa70;">where</span>
  fmap f (<span style="color: #8cc4ff;">Just</span> x) <span style="color: #fcaf3e;">=</span> <span style="color: #8cc4ff;">Just</span> (f x)
  fmap <span style="color: #b4fa70;">_</span> <span style="color: #8cc4ff;">Nothing</span> <span style="color: #fcaf3e;">=</span> <span style="color: #8cc4ff;">Nothing</span>
</code></pre>
</div>

</section>
</section>
<section>
<section id="slide-sec-">
<h2 id="org618171b">Functor Laws</h2>
<div class="outline-text-2" id="text-org618171b">
</div>
</section>
<section id="slide-sec-">
<h3 id="org6e6623b"></h3>
<p>
Not just any type class instance will suffice!<br />
</p>
<p class="fragment (appear)">
Many type class instances must follow certain laws.<br />
</p>
<p class="fragment (appear)">
For example, <code>Functor</code> instances must satisfy two laws.<br />
</p>

</section>
<section id="slide-sec-">
<h3 id="org9c711de">Functor Law 1: Identity Preservation</h3>
<div class="org-src-container">

<pre  class="fragment (appear)"><code trim><span style="color: #fce94f;">fmap</span> id <span style="color: #fcaf3e;">=</span> id
</code></pre>
</div>
<blockquote  class="fragment (appear)">
<p>
mapping id over a functorial value must return the functorial value unchanged.<br />
&#x2013; <a href="https://en.wikibooks.org/wiki/Haskell/The_Functor_class#The_functor_laws">Wikibooks</a><br />
</p>
</blockquote>

</section>
<section id="slide-sec-">
<h3 id="org04511ec">Functor Law 2: Composition Preservation</h3>
<div class="org-src-container">

<pre  class="fragment (appear)"><code trim><span style="color: #fce94f;">fmap</span> (f <span style="color: #fcaf3e;">.</span> g) <span style="color: #fcaf3e;">=</span> fmap f <span style="color: #fcaf3e;">.</span> fmap g
</code></pre>
</div>
<blockquote  class="fragment (appear)">
<p>
it should not matter whether we map a composed function or first map one function and then the other<br />
&#x2013; <a href="https://en.wikibooks.org/wiki/Haskell/The_Functor_class#The_functor_laws">Wikibooks</a><br />
</p>
</blockquote>
</section>
</section>
</div>
</div>
<script src="https://cdn.jsdelivr.net/npm/reveal.js@3.8.0/js/reveal.js"></script>

<script>
// Full list of configuration options available here:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({

controls: true,
progress: true,
history: false,
center: true,
slideNumber: 'c',
rollingLinks: false,
keyboard: true,
overview: true,

theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none
transitionSpeed: 'default',
multiplex: {
    secret: '', // null if client
    id: '', // id, obtained from socket.io server
    url: '' // Location of socket.io server
},

// Optional libraries used to extend on reveal.js
dependencies: [
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js@3.8.0/lib/js/classList.js', condition: function() { return !document.body.classList; } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js@3.8.0/plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js@3.8.0/plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js@3.8.0/plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
 { src: 'https://cdn.jsdelivr.net/npm/reveal.js@3.8.0/plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }]
});
</script>
</body>
</html>
